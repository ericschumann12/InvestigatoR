---
title: "Stock_prices_from_Yahoo_Finance_with_comments"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Fetching and Preparing Financial Data}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include=FALSE}
# Install and load necessary packages
install.packages("quantmod")
install.packages("tidyquant")
library(quantmod)
library(tidyquant)

# Suppress warnings related to getSymbols function
options("getSymbols.warning4.0" = FALSE)
options("getSymbols.yahoo.warning" = FALSE)

# Downloading Apple stock prices using quantmod from January 2017 to March 2018
getSymbols("AAPL", from = '2017-01-01', to = "2018-03-01", auto.assign = TRUE)

# View the first few rows of the Apple stock data
head(AAPL)

# Check the class of the Apple stock data object
class(AAPL)

# Plot the Apple stock price time series
chart_Series(AAPL)

# Zoom in on a specific period from December 2017 to March 2018
chart_Series(AAPL['2017-12/2018-03'])

# Define a list of multiple stock tickers
tickers <- c("AAPL", "NFLX", "AMZN", "K", "O")

# Download stock prices for multiple tickers from January 1, 2017, to January 15, 2017
getSymbols(tickers, from = "2017-01-01", to = "2017-01-15")

# Extract adjusted prices for each ticker and merge them into one object
prices <- map(tickers, function(x) Ad(get(x)))
prices <- reduce(prices, merge)
colnames(prices) <- tickers

# View the first few rows of the merged stock prices
head(prices)

# Check the class of the merged stock prices object
class(prices)

# Downloading Apple stock prices using tidyquant from January 2017 to March 2018
aapl <- tq_get('AAPL', from = "2017-01-01", to = "2018-03-01", get = "stock.prices")

# View the first few rows of the Apple stock data retrieved using tidyquant
head(aapl)

# Check the class of the Apple stock data object retrieved using tidyquant
class(aapl)

# Plot the Apple stock price time series using ggplot2
aapl %>%
  ggplot(aes(x = date, y = adjusted)) +
  geom_line() +
  theme_classic() +
  labs(x = 'Date', y = "Adjusted Price", title = "Apple price chart") +
  scale_y_continuous(breaks = seq(0, 300, 10))

# Define a list of multiple stock tickers
tickers <- c("AAPL", "NFLX", "AMZN", "K", "O")

# Download stock prices for multiple tickers using tidyquant from January 1, 2017, to March 1, 2017
prices <- tq_get(tickers, from = "2017-01-01", to = "2017-03-01", get = "stock.prices")

# View the first few rows of the stock data retrieved for multiple tickers
head(prices)

# Group the data by symbol and slice the first row for each symbol
prices %>%
  group_by(symbol) %>%
  slice(1)

# Plot the time series of adjusted stock prices for all tickers
prices %>%
  ggplot(aes(x = date, y = adjusted, color = symbol)) +
  geom_line() +
  facet_wrap(~symbol, scales = 'free_y') +
  theme_classic() +
  labs(x = 'Date', y = "Adjusted Price", title = "Price Chart") +
  scale_x_date(date_breaks = "month", date_labels = "%b\n%y")
```
